---
/**
 * ScrollToTop - Floating button that appears after scrolling
 * Smooth scroll back to top of page
 */
---

<button
  id="scroll-to-top"
  class="fixed bottom-24 right-6 z-40 w-12 h-12 rounded-full bg-gray-800 dark:bg-gray-200 text-white dark:text-gray-900 shadow-lg opacity-0 pointer-events-none transition-all duration-300 hover:bg-gray-700 dark:hover:bg-gray-300 hover:scale-110 focus:outline-none focus:ring-2 focus:ring-primary focus:ring-offset-2"
  aria-label="Scroll to top"
  title="Back to top"
>
  <span class="material-symbols-outlined" aria-hidden="true"
    >keyboard_arrow_up</span
  >
</button>

<style>
  #scroll-to-top {
    display: flex;
    align-items: center;
    justify-content: center;
  }

  #scroll-to-top.visible {
    opacity: 1;
    pointer-events: auto;
  }

  #scroll-to-top .material-symbols-outlined {
    font-size: 28px;
  }
</style>

<script>
  (function () {
    const btn = document.getElementById("scroll-to-top");
    if (!btn) return;

    const SCROLL_THRESHOLD = 300;

    function toggleVisibility() {
      if (window.scrollY > SCROLL_THRESHOLD) {
        btn.classList.add("visible");
      } else {
        btn.classList.remove("visible");
      }
    }

    // Throttle scroll events
    let ticking = false;
    window.addEventListener(
      "scroll",
      () => {
        if (!ticking) {
          window.requestAnimationFrame(() => {
            toggleVisibility();
            ticking = false;
          });
          ticking = true;
        }
      },
      { passive: true },
    );

    btn.addEventListener("click", () => {
      window.scrollTo({
        top: 0,
        behavior: "smooth",
      });
    });

    // Initial check
    toggleVisibility();
  })();
</script>
